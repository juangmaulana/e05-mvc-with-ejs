<% if (post) { %>
<div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
    <h1 style="margin: 0;">Post by <strong><%= post.posterName %></strong></h1>
    <div class="post-meta" style="text-align: right; font-size: 0.9em; color: #666;">
        Created: <%= new Date(post.createdAt).toLocaleString() %><br>
        Updated: <%= new Date(post.updatedAt).toLocaleString() %>
    </div>
</div>

<div style="margin: 20px 0; padding: 20px; background-color: #f9f9f9; border-left: 4px solid #007bff;">
    <%= post.content %>
</div>

<% if (post.replies && post.replies.length > 0) { %>
<div style="margin: 30px 0;">
    <h3 style="border-bottom: 2px solid #e9ecef; padding-bottom: 10px; margin-bottom: 20px;">Replies (<%= post.replies.length %>)</h3>
    <% post.replies.forEach(function(reply) { %>
        <div style="margin: 15px 0; padding: 15px; background-color: #f8f9fa; border-left: 4px solid #28a745; border-radius: 0 5px 5px 0;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <strong style="color: #28a745;"><%= reply.posterName %></strong>
                <span style="font-size: 0.8em; color: #666;"><%= new Date(reply.createdAt).toLocaleString() %></span>
            </div>
            <div style="margin-bottom: 10px;"><%= reply.content %></div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <a href="/posts/<%= reply.id %>" class="btn" style="font-size: 0.8em; padding: 5px 10px;">View</a>
                <a href="/posts/<%= reply.id %>/reply" class="btn" style="font-size: 0.8em; padding: 5px 10px; background-color: #28a745;">Reply</a>
                <% if (reply.replies && reply.replies.length > 0) { %>
                    <span style="font-size: 0.8em; color: #666;">
                        <a href="/posts/<%= reply.id %>" style="color: #007bff;"><%= reply.replies.length %> nested reply<%= reply.replies.length > 1 ? 'ies' : '' %></a>
                    </span>
                <% } %>
            </div>
        </div>
    <% }); %>
</div>
<% } %>

<div style="margin-top: 30px;">
    <a href="/posts" class="btn">← Back to Posts</a>
    <a href="/posts/<%= post.id %>/reply" class="btn" style="background-color: #28a745;">Reply to Post</a>
    <a href="/posts/<%= post.id %>/edit" class="btn">Edit Post</a>
    <form style="display: inline;" method="POST" action="/posts/<%= post.id %>/delete" onsubmit="return confirm('Are you sure you want to delete this post?')">
        <button type="submit" class="btn btn-danger">Delete Post</button>
    </form>
</div>
<% } else { %>
<div style="text-align: center; margin: 50px 0;">
    <h1>Post Not Found</h1>
    <p>The post you're looking for doesn't exist.</p>
    <a href="/posts" class="btn">← Back to Posts</a>
</div>
<% } %>