<h1>All Posts</h1>

<% if (posts && posts.length > 0) { %>
  <% posts.forEach(function(post) { %>
    <div class="post">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
            <h3 style="margin: 0;"><strong><%= post.posterName %></strong></h3>
            <span style="font-size: 0.8em; color: #666;"><%= new Date(post.createdAt).toLocaleString() %></span>
        </div>

        <p style="margin: 10px 0;"><a href="/posts/<%= post.id %>" style="color: #333; text-decoration: none;"><%= post.content %></a></p>

        <div style="margin-top: 15px;">
            <a href="/posts/<%= post.id %>" class="btn" style="font-size: 0.9em;">View</a>
            <a href="/posts/<%= post.id %>/reply" class="btn" style="font-size: 0.9em; background-color: #28a745;">Reply</a>
            <a href="/posts/<%= post.id %>/edit" class="btn" style="font-size: 0.9em;">Edit</a>
            <form style="display: inline;" method="POST" action="/posts/<%= post.id %>/delete" onsubmit="return confirm('Are you sure you want to delete this post?')">
                <button type="submit" class="btn btn-danger" style="font-size: 0.9em;">Delete</button>
            </form>
        </div>

        <% if (post.replies && post.replies.length > 0) { %>
            <div style="margin: 20px 0 0 20px; border-left: 3px solid #e9ecef; padding-left: 15px;">
                <h4 style="margin: 0 0 15px 0; font-size: 1em; color: #666;">Replies (<%= post.replies.length %>):</h4>
                <% post.replies.forEach(function(reply) { %>
                    <div style="margin: 10px 0; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <strong style="font-size: 0.9em;"><%= reply.posterName %></strong>
                            <span style="font-size: 0.8em; color: #666;"><%= new Date(reply.createdAt).toLocaleString() %></span>
                        </div>
                        <p style="margin: 0; font-size: 0.9em;"><a href="/posts/<%= reply.id %>" style="color: #333; text-decoration: none;"><%= reply.content %></a></p>
                    </div>
                <% }); %>
            </div>
        <% } %>
    </div>
  <% }); %>
<% } else { %>
  <p>No posts yet. <a href="/posts/new">Create the first post!</a></p>
<% } %>
